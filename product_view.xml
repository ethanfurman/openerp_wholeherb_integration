<?xml version="1.0"?>
<openerp>
    <data>

        <!-- Add external_id and salesinq tab to product.product -->
        <record id="product_normal_form_view_xml_id" model="ir.ui.view">
                <field name="name">view.product.product.form.xml_id</field>
                <field name="model">product.product</field>
                <field name="inherit_id" ref="product.product_normal_form_view"/>
                <field name="priority" eval="7"/>
                <field name="arch" type="xml">
                    <xpath expr="//div[@name='buttons']" position="inside">
                        <button name="button_fis_refresh" string="FIS Refresh" type="object"/>
                    </xpath>

                    <xpath expr="//div[@name='options']" position="inside">
                        <field name="product_is_blend"/>
                        <label for="product_is_blend"/>
                    </xpath>

                    <page string="Information" position="after">
                        <page string="Shipping Instructions">
                            <field name="spcl_ship_instr" nolabel="1" placeholder="Special shipping instructions here..."/>
                        </page>
                    </page>

                    <page string="Sales" position="after">
                        <page string="Lots">
                            <field name="lot_ids" nolabel="1">
                                <tree>
                                    <field name="name"/>
                                    <field name="cofo_id"/>
                                    <field name="amount_remaining"/>
                                    <field name="uom_id"/>
                                </tree>
                            </field>
                        </page>
                    </page>

                    <!--
                    <page string="Sales" position="after">
                        <page string="Ingredients">
                            <field name="ingredients_ids" nolabel="1">
                                <form>
                                    <field name="blend_id"/>
                                    <field name="percentinblend"/>
                                </form>
                                <tree>
                                    <field name="blend_id"/>
                                    <field name="percentinblend"/>
                                </tree>
                            </field>
                        </page>
                    </page>
                    -->

                    <field name="list_price" position="after">
                        <field name="sold_by"/>
                    </field>
                    <field name="default_code" position="replace">
                        <field name="latin"/>
                        <field name="xml_id"/>
                    </field>
                </field>
        </record>

        <record id="product_normal_action" model="ir.actions.act_window">
            <field name="name">Products</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">product.product</field>
            <field name="domain">['|',('product_tmpl_id.product_manager','=',uid),('product_tmpl_id.product_manager','=',False)]</field>
        </record>

        <record id="product_normal_action_sell" model="ir.actions.act_window">
            <field name="name">Products</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">product.product</field>
            <field name="domain">['|',('product_tmpl_id.product_manager','=',uid),('product_tmpl_id.product_manager','=',False)]</field>
        </record>

        <record id="product_category_list_view_xml_id" model="ir.ui.view">
            <field name="name">product.category.list.xml_id</field>
            <field name="model">product.category</field>
            <field name="inherit_id" ref="product.product_category_list_view"/>
            <field name="arch" type="xml">
                <field name="complete_name" position="after">
                    <field name='xml_id'/>
                </field>
            </field>
        </record>

        <record id="product_category_form_view_xml_id" model="ir.ui.view">
            <field name="name">product.category.form.xml_id</field>
            <field name="model">product.category</field>
            <field name="inherit_id" ref="product.product_category_form_view"/>
            <field name="arch" type="xml">
                <field name="parent_id" position="before">
                    <group colspan="4">
                        <field name='xml_id'/>
                    </group>
                </field>
            </field>
        </record>


        <record id="wholeherb_integration_blend_category_form" model="ir.ui.view">
            <field name="name">Product Blend Categories</field>
            <field name="model">wholeherb_integration.blend_category</field>
            <field name="arch" type="xml">
                <form string="Blend Category">
                    <field name="name"/>
                    <notebook colspan="4">
                        <page string="General Info">
                        </page>
                        <page string="Blends">
                            <field name="blends_ids" nolabel="1">
                                <form>
                                    <field name="code"/>
                                    <field name="name"/>
                                    <field name="packaging"/>
                                    <field name="special_instructions"/>
                                    <field name="amount"/>
                                    <field name="uom"/>
                                    <field name="batchsize"/>
                                    <field name="numberbatches"/>
                                </form>
                                <tree>
                                    <field name="code"/>
                                    <field name="name"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Notes (TBI)"/>
                    </notebook>
                </form>
            </field>
        </record>

        <record id="wholeherb_integration_blend_category_tree" model="ir.ui.view">
            <field name="name">product_blend_category</field>
            <field name="model">wholeherb_integration.blend_category</field>
            <field name="arch" type="xml">
                <tree string="categories">
                    <field name="name"/>
                </tree>
            </field>
        </record>

        <record id="action_wholeherb_integration_blend_category" model="ir.actions.act_window">
            <field name="name">Product Blend Categories</field>
            <field name="res_model">wholeherb_integration.blend_category</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="wholeherb_integration_blend_category_tree"/>
            <field name="view_mode">tree,form</field>
        </record>

        <menuitem
            name="Blend Categories"
            id="product_blend_categories"
            parent="product.prod_config_main"
            action="action_wholeherb_integration_blend_category"
            groups="base.group_user"
            />

        <record id="wholeherb_integration_blend_form" model="ir.ui.view">
            <field name="name">wholeherb_integration_blend</field>
            <field name="model">wholeherb_integration.blend</field>
            <field name="arch" type="xml">
                <form string="Blends">
                    <field name="code" colspan="4"/>
                    <field name="name" colspan="4"/>
                    <field name="category_name" colspan="4"/>
                    <notebook colspan="4">
                        <page string="General Info">
                            <field name="packaging"/>
                            <field name="special_instructions"/>
                            <field name="amount"/>
                            <field name="uom"/>
                            <field name="batchsize"/>
                            <field name="numberbatches"/>
                        </page>
                        <page string="Ingredients">
                            <field name="ingredients_ids" nolabel="1">
                                <form>
                                    <field name="product_id"/>
                                    <field name="percentinblend"/>
                                </form>
                                <tree>
                                    <field name="product_id"/>
                                    <field name="percentinblend"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Notes (TBI)"/>
                    </notebook>
                </form>
            </field>
        </record>


        <record id="wholeherb_integration_blend_tree" model="ir.ui.view">
            <field name="name">wholeherb_integration_blend_tree</field>
            <field name="model">wholeherb_integration.blend</field>
            <field name="arch" type="xml">
                <tree string="blends">
                    <field name="code"/>
                    <field name="name"/>
                    <field name="category_name"/>
                </tree>
            </field>
        </record>

        <record id="action_wholeherb_integration_blend" model="ir.actions.act_window">
            <field name="name">Product Blends</field>
            <field name="res_model">wholeherb_integration.blend</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="wholeherb_integration_blend_tree"/>
            <field name="view_mode">tree,form</field>
        </record>

        <menuitem
            name="Blends"
            id="wholeherb_integration_blend"
            parent="base.menu_product"
            action="action_wholeherb_integration_blend"
            groups="base.group_user"
            />

        <record id="wholeherb_integration_product_lot_form" model="ir.ui.view">
            <field name="name">wholeherb_integration_product_lot</field>
            <field name="model">wholeherb_integration.product_lot</field>
            <field name="arch" type="xml">
                <form string="Product Lots" version="7.0">
                    <div>
                        <h3>
                            <label for="name" string="Lot"/>
                            <field name="name" nolabel="1" class="oe_inline"/>
                            <separator/>
                            <label for="product_id" string="Item"/>
                            <field name="product_id" nolabel="1" class="oe_inline"/>
                        </h3>
                    </div>
                    <group>
                        <group string="Item Info">
                            <field name="cofo_id"/>
                            <field name="date_received"/>
                            <field name="uom_id"/>
                            <field name="amount_received"/>
                            <field name="amount_remaining"/>
                            <field name="prev_lot_no_id"/>
                        </group>
                        <group string="Vendor Info">
                            <field name="partner_id"/>
                            <field name="source_lot_no"/>
                            <field name="preship_id"/>
                            <field name="usda"/>
                            <field name="fda"/>
                            <field name="customs"/>
                        </group>
                    </group>
                </form>
            </field>
        </record>


        <record id="wholeherb_integration_product_lot_tree" model="ir.ui.view">
            <field name="name">wholeherb_integration_product_lot_tree</field>
            <field name="model">wholeherb_integration.product_lot</field>
            <field name="arch" type="xml">
                <tree string="product_lots">
                    <field name="name"/>
                    <field name="product_id"/>
                    <field name="amount_remaining"/>
                    <field name="cofo_id"/>
                </tree>
            </field>
        </record>

        <record id="action_wholeherb_integration_product_lot" model="ir.actions.act_window">
            <field name="name">Product Lots</field>
            <field name="res_model">wholeherb_integration.product_lot</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="wholeherb_integration_product_lot_tree"/>
            <field name="view_mode">tree,form</field>
        </record>

        <menuitem
            name="Lots"
            id="wholeherb_integration_product_lot"
            parent="base.menu_product"
            action="action_wholeherb_integration_product_lot"
            groups="base.group_user"
            />

    </data>

    <data noupdate="1">

        <record model="ir.cron" id="product_category_update">
            <field name="name">Product Categories Update</field>
            <field name="interval_number">1</field>
            <field name="interval_type">days</field>
            <field name="numbercall">-1</field>
            <field name="doall" eval="False"/>
            <field name="model" eval="'product.category'"/>
            <field name="function" eval="'fis_updates'"/>
            <field name="args" eval="'()'"/>
            <field name="nextcall" eval="'2013-04-09 08:00:00'"/>
            <field name="priority">100</field>
        </record>

        <record model="ir.cron" id="product_inventory_update">
            <field name="name">Product Inventory Update</field>
            <field name="interval_number">1</field>
            <field name="interval_type">days</field>
            <field name="numbercall">-1</field>
            <field name="doall" eval="False"/>
            <field name="model" eval="'product.product'"/>
            <field name="function" eval="'fis_updates'"/>
            <field name="args" eval="'()'"/>
            <field name="nextcall" eval="'2013-04-09 08:05:00'"/>
            <field name="priority">200</field>
        </record>

    </data>
</openerp>
